cmake_minimum_required(VERSION 3.10)
project(campus C)

set(CMAKE_C_STANDARD 11)

# Source files
file(GLOB SOURCES "src/main/*.c")

# Create executable
add_executable(campus ${SOURCES})

# Include directories
target_include_directories(campus PRIVATE include)

# Windows-specific setup
if(WIN32)
    target_include_directories(campus PRIVATE include/hpdf)
    target_link_directories(campus PRIVATE lib)
    target_link_libraries(campus PRIVATE hpdf)
    target_compile_definitions(campus PRIVATE _CRT_SECURE_NO_WARNINGS)
    
    # Copy DLL
    add_custom_command(TARGET campus POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy_if_different
        "${CMAKE_SOURCE_DIR}/lib/hpdf.dll"
        "$<TARGET_FILE_DIR:campus>"
    )
endif()

# Linux-specific setup  
if(UNIX)
    target_link_libraries(campus PRIVATE hpdf)
endif()